
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Week 9: The Discrete Fourier Transform (DFT) &#8212; The Data Science Labs on Fourier Analysis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 10: Frequency Analysis with the DFT" href="Signal_analysis_with_DFT.html" />
    <link rel="prev" title="Week 8: Chirps and Bells" href="modulation/chirp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Data Science Labs on Fourier Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About This Course
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preliminaries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro/intro_lab.html">
   Week 1: Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Synthesis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Playing_sound/1_play_sounds.html">
   Week 2: Playing Sound
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="build_a_synthesizer/build_a_synthesizer.html">
   Week 3: Build a synthesizer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="build_a_theremin/build_a_theremin.html">
   Week 4: Build a theremin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_experiencing_sound.html">
   Week 5: The human experience of sound
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Modulation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="modulation/am.html">
   Week 6: Tremolo/Beats Effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modulation/voice_changer_project.html">
   Week 7: Build a Voice Changer/Voice Shield
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modulation/chirp.html">
   Week 8: Chirps and Bells
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Week 9: The Discrete Fourier Transform (DFT)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Signal_analysis_with_DFT.html">
   Week 10: Frequency Analysis with the DFT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pedometer/pedometer_project.html">
   Week 10: Build a Pedometer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pedometer/pedo_frequency_project.html">
   Week 11: Step Detection versus Frequency Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tuning.html">
   Week 12: Tuning an instrument
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="instruments.html">
   Week 13: Identifying Music Instruments
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="filtering.html">
   Week ?: Sampled Signal Filtering with the Circular Convolution
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Design a project of your own
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="final_project.html">
   Week 14-15: Final Project
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Extra Materials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../extra_materials/intro_to_breadboards/intro_to_breadboards.html">
   Introduction to Breadboards
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/AldenMB/DSLab_Fourier/main?urlpath=tree/book/labs/dft.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/AldenMB/DSLab_Fourier"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/AldenMB/DSLab_Fourier/issues/new?title=Issue%20on%20page%20%2Flabs/dft.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/labs/dft.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-00-content-span">
   <span style="color:orange;">
    00. Content
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematics">
     Mathematics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-skills">
     Programming Skills
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embedded-systems">
     Embedded Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-0-required-hardware-span">
   <span style="color:orange;">
    0. Required Hardware
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-1-intro-span">
   <span style="color:orange;">
    1. Intro
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-1-span">
     <span style="color:red">
      Exercise 1
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-periodicity-of-the-sampling-span">
   <span style="color:orange;">
    2. Periodicity of the Sampling
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-2-span">
     <span style="color:red">
      Exercise 2
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-3-span">
     <span style="color:red">
      Exercise 3
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-4-span">
     <span style="color:red">
      Exercise 4
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-toy-example-of-signal-analysis-span">
   <span style="color:orange;">
    2. Toy Example of Signal Analysis
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-5-span">
     <span style="color:red">
      Exercise 5
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-6-span">
     <span style="color:red">
      Exercise 6
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-3-another-toy-example-of-signal-analysis-with-aliasing-span">
   <span style="color:orange;">
    3. Another Toy Example of Signal Analysis- with Aliasing
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-8-span">
     <span style="color:red">
      Exercise 8
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-9-span">
     <span style="color:red">
      Exercise 9
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-4-the-theory-span">
   <span style="color:orange;">
    4. The Theory
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-theorem">
   Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proof-of-the-sampling-theorem">
   Proof of the Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#special-case-of-the-sampling-theorem">
   Special case of the Sampling Theorem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-10-span">
     <span style="color:red">
      Exercise 10
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-5-the-fft-command-span">
   <span style="color:orange;">
    5. The FFT Command
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-11-span">
     <span style="color:red">
      Exercise 11
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-green-reflection-span">
   <span style="color:green;">
    Reflection
   </span>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Week 9: The Discrete Fourier Transform (DFT)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-00-content-span">
   <span style="color:orange;">
    00. Content
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematics">
     Mathematics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#programming-skills">
     Programming Skills
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embedded-systems">
     Embedded Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-0-required-hardware-span">
   <span style="color:orange;">
    0. Required Hardware
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-1-intro-span">
   <span style="color:orange;">
    1. Intro
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-1-span">
     <span style="color:red">
      Exercise 1
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-periodicity-of-the-sampling-span">
   <span style="color:orange;">
    2. Periodicity of the Sampling
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-2-span">
     <span style="color:red">
      Exercise 2
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-3-span">
     <span style="color:red">
      Exercise 3
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-4-span">
     <span style="color:red">
      Exercise 4
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-toy-example-of-signal-analysis-span">
   <span style="color:orange;">
    2. Toy Example of Signal Analysis
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-5-span">
     <span style="color:red">
      Exercise 5
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-6-span">
     <span style="color:red">
      Exercise 6
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-3-another-toy-example-of-signal-analysis-with-aliasing-span">
   <span style="color:orange;">
    3. Another Toy Example of Signal Analysis- with Aliasing
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-8-span">
     <span style="color:red">
      Exercise 8
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-9-span">
     <span style="color:red">
      Exercise 9
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-4-the-theory-span">
   <span style="color:orange;">
    4. The Theory
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-theorem">
   Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proof-of-the-sampling-theorem">
   Proof of the Sampling Theorem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#special-case-of-the-sampling-theorem">
   Special case of the Sampling Theorem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-10-span">
     <span style="color:red">
      Exercise 10
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-5-the-fft-command-span">
   <span style="color:orange;">
    5. The FFT Command
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-11-span">
     <span style="color:red">
      Exercise 11
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-green-reflection-span">
   <span style="color:green;">
    Reflection
   </span>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="week-9-the-discrete-fourier-transform-dft">
<h1>Week 9: The Discrete Fourier Transform (DFT)<a class="headerlink" href="#week-9-the-discrete-fourier-transform-dft" title="Permalink to this headline">#</a></h1>
<p><font size="6"> Laboratory 8 </font> <br>
<font size="3"> Last updated February 16, 2023 </font></p>
<section id="span-style-color-orange-00-content-span">
<h2><span style="color:orange;"> 00. Content </span><a class="headerlink" href="#span-style-color-orange-00-content-span" title="Permalink to this headline">#</a></h2>
<section id="mathematics">
<h3>Mathematics<a class="headerlink" href="#mathematics" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Fourier series</p></li>
<li><p>Euler’s formula</p></li>
<li><p>Sampling and Aliasing</p></li>
<li><p>Periodicity of discrete-time complex exponentials</p></li>
<li><p>orthogonality of discrete complex harmonics exponentials</p></li>
</ul>
</section>
<section id="programming-skills">
<h3>Programming Skills<a class="headerlink" href="#programming-skills" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>FFT</p></li>
</ul>
</section>
<section id="embedded-systems">
<h3>Embedded Systems<a class="headerlink" href="#embedded-systems" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>N/A</p></li>
</ul>
</section>
</section>
<section id="span-style-color-orange-0-required-hardware-span">
<h2><span style="color:orange;"> 0. Required Hardware </span><a class="headerlink" href="#span-style-color-orange-0-required-hardware-span" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>N/A</p></li>
</ul>
<h3 style="background-color:lightblue"> Write your name and email below: </h3>
<p><strong>Name:</strong> me</p>
<p><strong>Email:</strong> me &#64;purdue.edu</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-orange-1-intro-span">
<h2><span style="color:orange;"> 1. Intro </span><a class="headerlink" href="#span-style-color-orange-1-intro-span" title="Permalink to this headline">#</a></h2>
<p>The signals we acquire in real-life have a finite duration. We typically assume that they “start at zero,” meaning that they are equal to zero until <span class="math notranslate nohighlight">\(t=0\)</span>. After the signal duration is passed, i.e. when <span class="math notranslate nohighlight">\(t\)</span> is greater than the duration of the signal, then we also assume that the signal is equal to zero.</p>
<p>Putting this in mathematical terms: a finite duration signal <span class="math notranslate nohighlight">\(f(t)\)</span> takes the form $<span class="math notranslate nohighlight">\( f(t)=\left\{ \begin{array}{ll} f(t), &amp; 0\leq t &lt; \text{signal duration}, \\ 0, &amp; \text{ else.}\end{array}  \right. \)</span>$</p>
<p>In order to analyze a finite duration signal, we repeat it periodically with a period <span class="math notranslate nohighlight">\(P\)</span> that is at least as long as the duration of the signal. When <span class="math notranslate nohighlight">\(P\)</span> is strictly greater than the duraction, we say that the signal has been “zero padded” between the repetitions.</p>
<p>We assume that the repeated signal is such that it is equal to its Fourier series: $<span class="math notranslate nohighlight">\(f(t)= \frac{a_0}{2}+ \sum_{k=1}^\infty a_k \cos \left(\frac{2 \pi}{P} k t \right) + b_k \sin \left(\frac{2 \pi}{P} k t  \right).\)</span>$</p>
<p>We are interested in analyzing the signal <span class="math notranslate nohighlight">\(f(t)\)</span>. In real-life, we cannot do this directly by manipulating the function <span class="math notranslate nohighlight">\(f(t)\)</span>, as we typically only have access to a digital recording of <span class="math notranslate nohighlight">\(f(t)\)</span>. So, for example, computing the Fourier transform of <span class="math notranslate nohighlight">\(f(t)\)</span> (by integration) is not possible. We would like to be able to perform the analysis of <span class="math notranslate nohighlight">\(f(t)\)</span> by analysing its digital recording instead.</p>
<p>One important analysis to be performed is the estimations of the coefficients  <span class="math notranslate nohighlight">\(a_k,b_k\)</span> from the digital recording.</p>
<p>We assume that the digital recording takes the form of a discrete-time signal <span class="math notranslate nohighlight">\(f_d[n]\)</span>, with <span class="math notranslate nohighlight">\(n\in {\mathbb N}\)</span>, obtained by sampling the original signal <span class="math notranslate nohighlight">\(f(t)\)</span>. More specifically, we assume that <span class="math notranslate nohighlight">\(f_d[n]\)</span> is a uniform sampling of <span class="math notranslate nohighlight">\(f(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[f_d[n]=f(nT), \text{ for some } T&gt;0.\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(T\)</span> is called the <strong>sampling period</strong>. The quantity <span class="math notranslate nohighlight">\(\frac{1}{T}\)</span> is called the <strong>sampling frequency</strong>.   The sampling period <span class="math notranslate nohighlight">\(T\)</span> is the time difference between two sample points, and the sampling frequency represent how many samples are acquired per time unit.</p>
<p>In order to simplify the math, we rewrite <span class="math notranslate nohighlight">\(f(t)\)</span> in terms of complex exponentials: $<span class="math notranslate nohighlight">\( f(t)=  \sum_{k=-\infty}^\infty c_n e^{i \frac{2\pi}{P}kt} \)</span><span class="math notranslate nohighlight">\( where \)</span> c_0=\frac{a_0}{2} <span class="math notranslate nohighlight">\( and \)</span>c_n=c_{-n}^*=\frac{1}{2} (a_n- i b_n)<span class="math notranslate nohighlight">\(,  for \)</span>n&gt;1$.</p>
<section id="span-style-color-red-exercise-1-span">
<h3><span style="color:red"> Exercise 1 </span><a class="headerlink" href="#span-style-color-red-exercise-1-span" title="Permalink to this headline">#</a></h3>
<p>Derive the above formula. (Hint: replace each sine and cosine by sums of complex exponentials. If you do not know the sums already, find them using Euler’s formula <span class="math notranslate nohighlight">\(e^{i\theta}=\cos \theta + i \sin \theta\)</span>. B’Euler up! )</p>
<p>In the following, we will show how to recover the coefficients <span class="math notranslate nohighlight">\(a_k,b_k\)</span> using the <strong>Discrete Fourier Transform (DFT)</strong> of the sampling <span class="math notranslate nohighlight">\(f_n[n]\)</span>. The DFT transforms a periodic signal with period <span class="math notranslate nohighlight">\(N\)</span> into a sequence of complex numbers that is also periodic with period <span class="math notranslate nohighlight">\(N\)</span>. The numbers in the sequence are called the <strong>DFT coefficients.</strong></p>
<p>The formula for the <span class="math notranslate nohighlight">\(k^{th}\)</span> DFT coefficient of a sampled signal <span class="math notranslate nohighlight">\(f_d[n]\)</span> with period <span class="math notranslate nohighlight">\(N\)</span> is</p>
<div class="math notranslate nohighlight">
\[ F[k]= \sum_{n=0}^{N-1} f_d[n] e^{-i \frac{2 \pi}{N} k n }.  \]</div>
<p>As we will see later, in some circumstances, namely if</p>
<ul class="simple">
<li><p>the Fourier series of <span class="math notranslate nohighlight">\(f(t)\)</span> is finite, that is to say if <span class="math notranslate nohighlight">\(c_k=0\)</span> for all <span class="math notranslate nohighlight">\(|k|&gt;N_0\)</span>, and</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> is large enough,</p></li>
</ul>
<p>then we have</p>
<div class="math notranslate nohighlight">
\[F[k]= N c_k, \text{ for all }0\leq k \leq N_0.\]</div>
<p>Therefore, in those circumstances, one can recover the Fourier series coefficients <span class="math notranslate nohighlight">\(a_k=2 (c_k+c_k^*)\)</span>, <span class="math notranslate nohighlight">\(b_k=2(c_k-c_k^*)\)</span> of the signal <span class="math notranslate nohighlight">\(f(t)\)</span> from the DFT coefficients of the sampled signal. The rest of the lab explores and clarifies this.</p>
</section>
</section>
<section id="span-style-color-orange-2-periodicity-of-the-sampling-span">
<h2><span style="color:orange;"> 2. Periodicity of the Sampling </span><a class="headerlink" href="#span-style-color-orange-2-periodicity-of-the-sampling-span" title="Permalink to this headline">#</a></h2>
<p>In order for the proposed analysis method to work, the sampled signal must be periodic. In other words, there must exist an integer <span class="math notranslate nohighlight">\(N\)</span> such that</p>
<div class="math notranslate nohighlight">
\[ f_d[n+N] = f_d[n], \forall n.\]</div>
<p>Depending on the sampling period <span class="math notranslate nohighlight">\(T\)</span> chosen, the sampled signal may or may not be periodic.</p>
<section id="span-style-color-red-exercise-2-span">
<h3><span style="color:red"> Exercise 2 </span><a class="headerlink" href="#span-style-color-red-exercise-2-span" title="Permalink to this headline">#</a></h3>
<p>If the signal <span class="math notranslate nohighlight">\(f(t)=e^{i \frac{2\pi}{10} t }\)</span> is sampled with a sampling period <span class="math notranslate nohighlight">\(T=2\)</span>, show that the resulting sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span> is periodic with period <span class="math notranslate nohighlight">\(N=5\)</span>. (Use either code or mathematics.)</p>
</section>
<section id="span-style-color-red-exercise-3-span">
<h3><span style="color:red"> Exercise 3 </span><a class="headerlink" href="#span-style-color-red-exercise-3-span" title="Permalink to this headline">#</a></h3>
<p>If the signal <span class="math notranslate nohighlight">\(f(t)=e^{i \frac{2\pi}{10} t }\)</span> is sampled with a sampling period <span class="math notranslate nohighlight">\(T=3\)</span>, show that the resulting sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span> is periodic with period <span class="math notranslate nohighlight">\(N=10\)</span>. (Use either code or mathematics.)</p>
</section>
<section id="span-style-color-red-exercise-4-span">
<h3><span style="color:red"> Exercise 4 </span><a class="headerlink" href="#span-style-color-red-exercise-4-span" title="Permalink to this headline">#</a></h3>
<p>If the signal <span class="math notranslate nohighlight">\(f(t)=e^{i \frac{2\pi}{10} t }\)</span> is sampled with a sampling period <span class="math notranslate nohighlight">\(T=\sqrt{2}\)</span>, show that the resulting sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span> is not periodic/ (Here you must use mathematics.)</p>
<p>In general, <span class="math notranslate nohighlight">\(f_d[n]= f(n T)\)</span> is periodic  if an only if <span class="math notranslate nohighlight">\(\frac{P}{T}\)</span> is a rational number. That means that we can write <span class="math notranslate nohighlight">\(\frac{P}{T}\)</span> as a ratio of two integers:
$<span class="math notranslate nohighlight">\(\frac{P}{T}=\frac{N}{K}.\)</span><span class="math notranslate nohighlight">\( 
If \)</span>N<span class="math notranslate nohighlight">\( and \)</span>K<span class="math notranslate nohighlight">\( have no common factor, then \)</span>N<span class="math notranslate nohighlight">\( is the fundamental period of \)</span>f_d[n]$.</p>
<p>For example, if <span class="math notranslate nohighlight">\(T=\frac{P}{N}\)</span>, then we acquire <span class="math notranslate nohighlight">\(N\)</span> samples per period, and <span class="math notranslate nohighlight">\(f_d[n]\)</span> is periodic with period <span class="math notranslate nohighlight">\(N\)</span>. Similarly, if <span class="math notranslate nohighlight">\(T=\frac{2 P}{N}\)</span>, then we acquire <span class="math notranslate nohighlight">\(N\)</span> samples per two periods, which corresponds to <span class="math notranslate nohighlight">\(\frac{N}{2}\)</span> samples per period. If <span class="math notranslate nohighlight">\(N\)</span> is odd, then <span class="math notranslate nohighlight">\(f_d[n]\)</span> has period <span class="math notranslate nohighlight">\(N\)</span> (it has to be an integer). If <span class="math notranslate nohighlight">\(N\)</span> is even, <span class="math notranslate nohighlight">\(f_d[n]\)</span> has period <span class="math notranslate nohighlight">\(\frac{N}{2}\)</span>.</p>
</section>
</section>
<section id="span-style-color-orange-2-toy-example-of-signal-analysis-span">
<h2><span style="color:orange;"> 2. Toy Example of Signal Analysis </span><a class="headerlink" href="#span-style-color-orange-2-toy-example-of-signal-analysis-span" title="Permalink to this headline">#</a></h2>
<p>Suppose the signal recorded, once repeated periorically, is of the form $<span class="math notranslate nohighlight">\(  f(t)= a_1 \cos \left(2 \pi 100 t \right) + a_4 \cos \left(2 \pi 400 t  \right). \)</span><span class="math notranslate nohighlight">\(
So the signal has period \)</span>P=\frac{1}{100}$.</p>
<p>Given is a recording with 1000 samples per unit of time (so the sampling period is <span class="math notranslate nohighlight">\(T=\frac{1}{1000}\)</span>): $<span class="math notranslate nohighlight">\( f_d[n] = f( n \frac{1} {1000}).\)</span>$
More specifically, the recorded signal is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
f_d[n]&amp;= a_1 \cos \left(2 \pi 100 \frac{n} {1000} \right) + a_4 \cos \left(2 \pi 400  \frac{n} {1000}  \right)\\
&amp;= a_1 \cos \left(2 \pi \frac{n}{10} \right) + a_4 \cos \left(2 \pi 4 \frac{n}{10} \right). 
\end{aligned} \end{split}\]</div>
<p>Observe that <span class="math notranslate nohighlight">\(f_d[n]\)</span> is periodic, with period <span class="math notranslate nohighlight">\(N=10\)</span>. This is because we are taking <span class="math notranslate nohighlight">\(10\)</span> samples per period (since <span class="math notranslate nohighlight">\(\frac{P}{T}=\frac{1000}{100}=10\)</span>).</p>
<p>Let us write <span class="math notranslate nohighlight">\(f_d[n]\)</span> in terms of complex exponentials: $<span class="math notranslate nohighlight">\( f_d[n]= \frac{a_1}{2} \left(e^{i  2 \pi \frac{n}{10}}+ e^{-i 2 \pi \frac{n}{10}}\right) + \frac{a_4}{2}\left(e^{i 2 \pi  4 \frac{n}{10}}+ e^{-i 2 \pi 4 \frac{n}{10}}\right). \)</span>$</p>
<p>Now let us compute the first coefficient <span class="math notranslate nohighlight">\(F[1]\)</span> of the 10-point DFT of <span class="math notranslate nohighlight">\(f_d[n]\)</span>.</p>
<p>We have
$<span class="math notranslate nohighlight">\( \begin{aligned}
F[1]&amp;= \sum_{n=0}^{9} f_d[n]  e^{-i \frac{2\pi}{10} n} \\
&amp;= \sum_{n=0}^{9} \left( \frac{a_1}{2} \left(e^{i 2 \pi \frac{n}{10}}+ e^{-i 2 \pi \frac{n}{10}}\right) 
+
\frac{a_4}{2}\left(e^{i 2 \pi  4 \frac{n}{10}}+ e^{-i 2 \pi 4 \frac{n}{10}}\right)\right)  e^{-i \frac{2\pi}{10}  n} \\
&amp;= 10 \frac{a_1}{2}
\end{aligned}\)</span><span class="math notranslate nohighlight">\(
where we used the fact that 
\)</span><span class="math notranslate nohighlight">\( \sum_{n=0}^{N-1} e^{j \frac{2\pi}{N} k_1 n } e^{j \frac{2\pi}{N} k_2 n } = \left\{ 
\begin{array}{cc}
    N &amp;, \text{ if } k_1-k_2  \text{ is a multiple of } N  \\
   0  &amp;, \text{ else}. 
\end{array}
\right.\)</span><span class="math notranslate nohighlight">\(
Therefore, \)</span>a_1=2 \frac{F[1]}{10}<span class="math notranslate nohighlight">\(. So we are able to obtain the value of \)</span>a_1<span class="math notranslate nohighlight">\( from the value of \)</span>F[1]$.</p>
<section id="span-style-color-red-exercise-5-span">
<h3><span style="color:red"> Exercise 5 </span><a class="headerlink" href="#span-style-color-red-exercise-5-span" title="Permalink to this headline">#</a></h3>
<p>Test the formula <span class="math notranslate nohighlight">\(a_1=2 \frac{ F[1]}{10}\)</span> as follows:</p>
<ul class="simple">
<li><p>pick the values of <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a_4\)</span>.</p></li>
<li><p>replace the chosen values in the function <span class="math notranslate nohighlight">\(  f(t)= a_1 \cos \left(2 \pi 100 t \right) + a_4 \cos \left(2 \pi 400 t  \right)\)</span>.</p></li>
<li><p>Sample the function <span class="math notranslate nohighlight">\(f(t)\)</span> with a sampling period <span class="math notranslate nohighlight">\(T=1000^{=1}\)</span> to obtain the sampling <span class="math notranslate nohighlight">\( f_d[n]\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(F[1]\)</span> using the formula  <span class="math notranslate nohighlight">\(F[1]=\sum_{n=0}^{9} f_d[n]  e^{-i \frac{2\pi}{10} n}\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(a_1\)</span> using the formula <span class="math notranslate nohighlight">\(a_1=2 \frac{ F[1]}{10}\)</span>.</p></li>
<li><p>Compare the value of <span class="math notranslate nohighlight">\(a_1\)</span> you obtained to the original value of <span class="math notranslate nohighlight">\(a_1\)</span> you had chosen. Is it the same?</p></li>
</ul>
<p>Similarly, we can recover <span class="math notranslate nohighlight">\(a_4\)</span> from <span class="math notranslate nohighlight">\(F[4]\)</span>. Indeed, we have
$<span class="math notranslate nohighlight">\( \begin{aligned}
F[4]&amp;= \sum_{n=0}^{9} f_d[n]  e^{-i \frac{2\pi}{10} 4 n} \\
&amp;= \sum_{n=0}^{4} \left( \frac{a_1}{2} \left(e^{i 2 \pi \frac{n}{10}}+ e^{-i 2 \pi  \frac{n}{10}}\right) 
+
\frac{a_4}{2}\left(e^{i 2 \pi  4 \frac{n}{10}}+ e^{-i 2 \pi 4 \frac{n}{10}}\right)\right) e^{-i \frac{2\pi}{5} 4 n} \\
&amp;= 10 \frac{a_4}{2},
\end{aligned}\)</span>$
again by using the fact that</p>
<div class="math notranslate nohighlight">
\[\begin{split} \sum_{n=0}^{N-1} e^{j \frac{2\pi}{N} k_1 n } e^{j \frac{2\pi}{N} k_2 n } = \left\{ 
\begin{array}{cc}
    N &amp;, \text{ if } k_1-k_2  \text{ is a multiple of } N  \\
   0  &amp;, \text{ else}. 
\end{array}
\right.\end{split}\]</div>
<p>Therefore, <span class="math notranslate nohighlight">\(a_4=2 \frac{F[4]}{10}\)</span>. So we are able to obtain the value of <span class="math notranslate nohighlight">\(a_4\)</span> from the value of <span class="math notranslate nohighlight">\(F[4]\)</span>.</p>
</section>
<section id="span-style-color-red-exercise-6-span">
<h3><span style="color:red"> Exercise 6 </span><a class="headerlink" href="#span-style-color-red-exercise-6-span" title="Permalink to this headline">#</a></h3>
<p>Test the formula <span class="math notranslate nohighlight">\(a_4=2 \frac{F[4]}{10}\)</span> in the same was as you did for Exercise 5.</p>
</section>
</section>
<section id="span-style-color-orange-3-another-toy-example-of-signal-analysis-with-aliasing-span">
<h2><span style="color:orange;"> 3. Another Toy Example of Signal Analysis- with Aliasing </span><a class="headerlink" href="#span-style-color-orange-3-another-toy-example-of-signal-analysis-with-aliasing-span" title="Permalink to this headline">#</a></h2>
<p>Again, we assume thay the signal recorded is known to be of the form
$<span class="math notranslate nohighlight">\(  f(t)= a_1 \cos \left(2 \pi 100 t \right) + a_4 \cos \left(2 \pi 400  t  \right). \)</span><span class="math notranslate nohighlight">\(
So the signal has period \)</span>P=\frac{1}{100}$.</p>
<p>But this time, we are given a recording with only 500 samples per unit of time (so the sampling period is <span class="math notranslate nohighlight">\(T=\frac{1}{500}\)</span>):
$<span class="math notranslate nohighlight">\( f_d[n] = f( n \frac{1} {500}).\)</span><span class="math notranslate nohighlight">\(
More specifically, the recorded signal is  
\)</span><span class="math notranslate nohighlight">\( \begin{aligned}
f_d[n]&amp;= a_1 \cos \left(2 \pi 100 \frac{n} {500} \right) + a_4 \cos \left(2 \pi 400  \frac{n} {500}  \right)\\
&amp;= a_1 \cos \left(2 \pi  \frac{n}{5} \right) + a_4 \cos \left(2 \pi 4 \frac{n}{5} \right). 
\end{aligned} \)</span>$</p>
<p>Here <span class="math notranslate nohighlight">\(f_d[n]\)</span> is periodic with period <span class="math notranslate nohighlight">\(N=5\)</span>. This is because we are taking <span class="math notranslate nohighlight">\(5\)</span> samples per signal period (since <span class="math notranslate nohighlight">\(\frac{P}{T}=\frac{500}{100}=5\)</span>).</p>
<p>Let us write <span class="math notranslate nohighlight">\(f_d[n]\)</span> in terms of complex exponentials:
$<span class="math notranslate nohighlight">\( \begin{aligned}
f_d[n]&amp;= \frac{a_1}{2} \left(e^{i 2 \pi  \frac{n}{5}}+ e^{-i 2 \pi  \frac{n}{5}}\right) 
+
\frac{a_2}{2}\left(e^{i 2 \pi  4 \frac{n}{5}}+ e^{-i 2 \pi 4 \frac{n}{5}}\right).
\end{aligned} \)</span>$</p>
<p>Now let us compute the first coefficient <span class="math notranslate nohighlight">\(F[1]\)</span> of the 5-point DFT of <span class="math notranslate nohighlight">\(f_d[n]\)</span>.</p>
<p>We have
$<span class="math notranslate nohighlight">\( \begin{aligned}
F[1]&amp;= \sum_{n=0}^{4} f_d[n]  e^{-i \frac{2\pi}{5} n} \\
&amp;= \sum_{n=0}^{4} \left( \frac{a_1}{2} \left(e^{i 2 \pi \frac{n}{5}}+ e^{-i 2 \pi  \frac{n}{5}}\right) 
+
\frac{a_4}{2}\left(e^{i 2 \pi  4 \frac{n}{5}}+ e^{-i 2 \pi 4 \frac{n}{5}}\right)\right) e^{-i \frac{2\pi}{5} 4 n} \\
&amp;= 5 \frac{a_1}{2} + 5 \frac{a_2}{2}.
\end{aligned} \)</span><span class="math notranslate nohighlight">\(
since
\)</span><span class="math notranslate nohighlight">\( \sum_{n=0}^{N-1} e^{j \frac{2\pi}{N} k_1 n } e^{j \frac{2\pi}{N} k_2 n } = \left\{ 
\begin{array}{cc}
    N &amp;, \text{ if } k_1-k_2  \text{ is a multiple of } N  \\
   0  &amp;, \text{ else}. 
\end{array}
\right.\)</span>$</p>
<p>Thus, in this case, <span class="math notranslate nohighlight">\(F[1]\)</span> does not give us the value of <span class="math notranslate nohighlight">\(a_1\)</span> anymore, but rather only the sum of <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a_2\)</span>.</p>
<p>The reason for this is fundamental: the function <span class="math notranslate nohighlight">\(e^{i 2 \pi  4 \frac{n}{5}}\)</span> is the same as the function <span class="math notranslate nohighlight">\(e^{-i 2 \pi   \frac{n}{5}}\)</span>. So we cannot recover the coefficients separately because the two exponential signals, once sampled, become the same signal. Indeed, the sampled signal can be written as
$<span class="math notranslate nohighlight">\( f_d[n]= \left( \frac{a_1}{2} +  \frac{a_2}{2} \right) e^{i 2\pi  \frac{n}{5}}+ \left( \frac{a_1}{2} +  \frac{a_2}{2} \right) e^{-i 2\pi  \frac{n}{5}}.\)</span>$</p>
<p>Another way to see this is to observe that <span class="math notranslate nohighlight">\(\cos (2 \pi 4 \frac{n}{5})= \cos(2 \pi 4 \frac{n}{5}- 2\pi n )= \cos (-2 \pi  \frac{n}{5})=  \cos (2 \pi  \frac{n}{5})\)</span>.</p>
<p>So the signal <span class="math notranslate nohighlight">\(f_d[n]\)</span> can be written as $<span class="math notranslate nohighlight">\( \begin{aligned}
f_d[n]&amp;= a_1 \cos \left(2 \pi  \frac{n}{5} \right) + a_4 \cos \left(2 \pi 4 \frac{n}{5} \right),\\
&amp;= a_1 \cos \left(2 \pi  \frac{n}{5} \right)+ a_4 \cos \left(2 \pi \frac{n}{5} \right),\\
&amp;= (a_1+a_4) \cos \left(2 \pi  \frac{n}{5} \right).
\end{aligned} \)</span>$
This phenomenon is called “aliasing.”</p>
<section id="span-style-color-red-exercise-8-span">
<h3><span style="color:red"> Exercise 8 </span><a class="headerlink" href="#span-style-color-red-exercise-8-span" title="Permalink to this headline">#</a></h3>
<p>Check, numerically, that sampling <span class="math notranslate nohighlight">\(\cos (2\pi 100 t)\)</span> or <span class="math notranslate nohighlight">\(\cos (2\pi 100 t)\)</span>  with a period <span class="math notranslate nohighlight">\(T=\frac{1}{500}\)</span> in either cases yield the same discrete-time signal <span class="math notranslate nohighlight">\(f_d[n]\)</span>.</p>
</section>
<section id="span-style-color-red-exercise-9-span">
<h3><span style="color:red"> Exercise 9 </span><a class="headerlink" href="#span-style-color-red-exercise-9-span" title="Permalink to this headline">#</a></h3>
<p>Use an approach similar to that of Exercise 5 to show, numerically, that in the toy example with aliasing above, we have <span class="math notranslate nohighlight">\(\frac{2}{5} F[1]= a_1+a_2\)</span> (as opposed to <span class="math notranslate nohighlight">\(\frac{2}{5} F[1]= a_1\)</span>).</p>
</section>
</section>
<section id="span-style-color-orange-4-the-theory-span">
<h2><span style="color:orange;"> 4. The Theory </span><a class="headerlink" href="#span-style-color-orange-4-the-theory-span" title="Permalink to this headline">#</a></h2>
<p>The aliasing phenomenon is well understood. In fact, you may have heard about the Nyquist criterion: a condition that, if satisfied, guarantees that aliasing will not uccur. In this lab, we will not dwelve further into this criterion per say but, instead, jump directly to the topic of interest, which is to analyze a signal <span class="math notranslate nohighlight">\(f(t)\)</span> from a sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span>. By “analysing” we mean recovering the Fourier series coefficients <span class="math notranslate nohighlight">\(c_k\)</span>.</p>
<p>Recall that the <strong>(N-point) DFT</strong> of a signal <span class="math notranslate nohighlight">\(f_d[n]\)</span> with period <span class="math notranslate nohighlight">\(N\)</span> is defined as the discrete-time signal</p>
<div class="math notranslate nohighlight">
\[ F[k]= \sum_{n=0}^{N-1} f_d[n] e^{-i \frac{2 \pi}{N} k n },  \]</div>
<p>and the value of <span class="math notranslate nohighlight">\(F[k]\)</span>  is called the <strong>k-th coefficients of the DFT</strong> of the signal.</p>
<p>It turns out that the DFT coefficients give us the value of the Fourier series coefficients of <span class="math notranslate nohighlight">\(f(t)\)</span>, provided that we have taken “enough” samples considering the number of non-zero coefficients in the Fourier series of <span class="math notranslate nohighlight">\(f(t)\)</span>. More specifically, we have the following theorem.</p>
</section>
<section id="sampling-theorem">
<h2>Sampling Theorem<a class="headerlink" href="#sampling-theorem" title="Permalink to this headline">#</a></h2>
<p>If f(t) has a finite Fourier series with <span class="math notranslate nohighlight">\(2K+1\)</span> terms</p>
<div class="math notranslate nohighlight">
\[f(t)=\sum_{k=-K}^K c_k e^{i \frac{2\pi}{P} k t} = \frac{a_0}{2}+ \sum_{k=1}^K a_k \cos \left(\frac{2 \pi}{P} k t \right) + b_k \sin \left(\frac{2 \pi}{P} k t  \right). \]</div>
<p>(so its maximum frequency is <span class="math notranslate nohighlight">\(K\frac{1}{P}\)</span>), and if we sample f(t) with a sampling frequency <span class="math notranslate nohighlight">\(\frac{1}{T}\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\frac{1}{T} &gt; 2 K\frac{1}{P}\]</div>
<p>which results in a periodic sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span> with period <span class="math notranslate nohighlight">\(N=\frac{P}{T} R\)</span> for some integer <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Then the N-point DFT of <span class="math notranslate nohighlight">\(f_d[n]\)</span> gives the values of coefficients <span class="math notranslate nohighlight">\(c_k\)</span> of the Fourier series of <span class="math notranslate nohighlight">\(f(t)\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[F[k]= N c_k= N\frac{1}{2}(a_k-ib_k), \text{ for all }  0\leq k \leq K.\]</div>
</section>
<section id="proof-of-the-sampling-theorem">
<h2>Proof of the Sampling Theorem<a class="headerlink" href="#proof-of-the-sampling-theorem" title="Permalink to this headline">#</a></h2>
<p>The proof of the sampling theorem follows the same model as the computation performed in the toy examples.</p>
<p>We start from the formula for the DFT coefficients and replace <span class="math notranslate nohighlight">\(f_d[n]\)</span> by its expression in terms of complex exponentials.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
F[k]&amp;= \sum_{n=0}^{N-1} f_d[n]  e^{-i \frac{2\pi}{N} k n} \\
&amp;=  \sum_{n=0}^{N-1} f(nT) e^{-i \frac{2\pi}{N} k n} \\
&amp;=  \sum_{n=0}^{N-1} \sum_{k'=-K}^K c_{k'} e^{i \frac{2\pi}{P} k' n T } e^{-i \frac{2\pi}{N} k n}.
\end{aligned} \end{split}\]</div>
<p>Since the sampling is assumed to be periodic with period <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(\frac{P}{T}=\frac{N}{R}\)</span> for some integer <span class="math notranslate nohighlight">\(R\)</span>.
Replacing <span class="math notranslate nohighlight">\(\frac{P}{T}\)</span> by <span class="math notranslate nohighlight">\(\frac{N}{R}\)</span> in the right-hand-side yields</p>
<div class="math notranslate nohighlight">
\[ \begin{aligned}
F[k] &amp;=  \sum_{n=0}^{N-1} \sum_{k'=-K}^K c_{k'} e^{i \frac{2\pi}{N} k' R n T } e^{-i \frac{2\pi}{N} k n}.
\end{aligned} \]</div>
<p>Then we simplify the right-hand-side by permuting the two sums and using the orthogonality property of the complex exponentials:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \sum_{n=0}^{N-1} e^{j \frac{2\pi}{N} k_1 n } e^{j \frac{2\pi}{N} k_2 n } = \left\{ 
\begin{array}{cc}
    N &amp;, \text{ if } k_1-k_2  \text{ is a multiple of } N  \\
   0  &amp;, \text{ else}. 
\end{array}
\right.  \end{split}\]</div>
<p>Step-by-step, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
F[k] &amp;=  \sum_{k'=-K}^K \sum_{n=0}^{N-1}  c_{k'} e^{i \frac{2\pi}{N} k' R n T } e^{-i \frac{2\pi}{N} k n}\\
&amp;= \sum_{k'=-K}^K  c_{k'} \sum_{n=0}^{N-1}  e^{i \frac{2\pi}{N} k' R n T } e^{-i \frac{2\pi}{N} k n} \\
&amp;= \sum_{k'=-K}^K  c_{k'} \left\{ 
\begin{array}{cc}
    N &amp;, \text{ if } k'R-k  \text{ is a multiple of } N  \\
   0  &amp;, \text{ else}. 
\end{array}
\right.  \\
\end{aligned} \end{split}\]</div>
<p>Now if <span class="math notranslate nohighlight">\(\frac{1}{T} &gt; 2 K \frac{1}{P}\)</span>, we have <span class="math notranslate nohighlight">\(\frac{P}{T} &gt; 2 K\)</span> and thus  <span class="math notranslate nohighlight">\(\frac{N}{R} &gt; 2 K\)</span>, so  <span class="math notranslate nohighlight">\(N &gt; 2 K R\)</span>. This implies that the only <span class="math notranslate nohighlight">\(k'\)</span> in the range <span class="math notranslate nohighlight">\(k'\in \{ -N, -N+1, \ldots, N \}\)</span> which is such that <span class="math notranslate nohighlight">\(k'R\)</span> a multiple of <span class="math notranslate nohighlight">\(N\)</span> is <span class="math notranslate nohighlight">\(k'=0\)</span>. Likewise, the only <span class="math notranslate nohighlight">\(k'\)</span> in the range <span class="math notranslate nohighlight">\(k'\in \{ -N, -N+1, \ldots, N \}\)</span> which is such that <span class="math notranslate nohighlight">\(k'R\)</span> a multiple of <span class="math notranslate nohighlight">\(N\)</span> plus <span class="math notranslate nohighlight">\(k\)</span> is <span class="math notranslate nohighlight">\(k'=k\)</span>. Thus the right-hand-side sum simplifies to</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{aligned}
F[k] &amp;=   N c_{k} \\
\end{aligned} \end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\square\)</span></p>
<p>In the special case where <span class="math notranslate nohighlight">\(\frac{P}{T}=N\)</span> is an integer, the theorem is even simpler to state.</p>
</section>
<section id="special-case-of-the-sampling-theorem">
<h2>Special case of the Sampling Theorem<a class="headerlink" href="#special-case-of-the-sampling-theorem" title="Permalink to this headline">#</a></h2>
<p>If a signal <span class="math notranslate nohighlight">\(f(t)\)</span> of the form</p>
<div class="math notranslate nohighlight">
\[f(t)=\sum_{k=-K}^K c_k e^{i \frac{2\pi}{P} k t}= \frac{a_0}{2}+ \sum_{k=1}^K a_k \cos \left(\frac{2 \pi}{P} k t \right) + b_k \sin \left(\frac{2 \pi}{P} k t  \right)\]</div>
<p>is sampled in such a way that</p>
<ul class="simple">
<li><p>exactly <span class="math notranslate nohighlight">\(N\)</span> samples per period are taken (i.e., <span class="math notranslate nohighlight">\(\frac{P}{T}=N\)</span> is an integer), and</p></li>
<li><p><span class="math notranslate nohighlight">\(N&gt;2K\)</span></p></li>
</ul>
<p>then the DFT coefficients <span class="math notranslate nohighlight">\(F[k]\)</span> satisfy</p>
<div class="math notranslate nohighlight">
\[F[k]= N c_k= N\frac{1}{2}(a_k-ib_k), \text{ for all } 0\leq k \leq K.\]</div>
<section id="span-style-color-red-exercise-10-span">
<h3><span style="color:red"> Exercise 10 </span><a class="headerlink" href="#span-style-color-red-exercise-10-span" title="Permalink to this headline">#</a></h3>
<p>Illustrate the Sampling Theorem with a numerical example:</p>
<ul class="simple">
<li><p>Write a  periodic signal <span class="math notranslate nohighlight">\(f(t)\)</span> as as a linear combination of  sines and cosines.</p></li>
<li><p>Build a sampling <span class="math notranslate nohighlight">\(f_d[n]=f(nT)\)</span> with an appropriate sampling period <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
<li><p>Compute the DFT coefficients of the sampling</p></li>
<li><p>Ue the formula from the theorem to recover the coefficients <span class="math notranslate nohighlight">\(a_k\)</span> <span class="math notranslate nohighlight">\(b_k\)</span> of the linear combination from the DFT coefficients.</p></li>
</ul>
</section>
</section>
<section id="span-style-color-orange-5-the-fft-command-span">
<h2><span style="color:orange;"> 5. The FFT Command </span><a class="headerlink" href="#span-style-color-orange-5-the-fft-command-span" title="Permalink to this headline">#</a></h2>
<p>In the previous exercise, you had to write your own function to compute a DFT. Running your function may have taken a long time, especially if you used loops. Python has a quick command to compute a DFT. The command uses a fast algorithm called a Fast Fourier Transform (FFT) to compute the DFT.  Here is the synthax. CODE NEEDS TO BE ADDED HERE.</p>
<section id="span-style-color-red-exercise-11-span">
<h3><span style="color:red"> Exercise 11 </span><a class="headerlink" href="#span-style-color-red-exercise-11-span" title="Permalink to this headline">#</a></h3>
<p>Repeat exercise 10, but this time, use the FFT command.</p>
</section>
</section>
<section id="span-style-color-green-reflection-span">
<h2><span style="color:green;"> Reflection </span><a class="headerlink" href="#span-style-color-green-reflection-span" title="Permalink to this headline">#</a></h2>
<p>Do not skip this section! It will be graded but only on completion.</p>
<p><strong>1. What parts of the lab, if any, do you feel you did well? <br>
2. What are some things you learned today? <br>
3. Are there any topics that could use more clarification? <br>
4. Do you have any suggestions on parts of the lab to improve?</strong></p>
<h3 style="background-color:lightblue"> Write Answers for the Reflection Below </h3></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./labs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="modulation/chirp.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Week 8: Chirps and Bells</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Signal_analysis_with_DFT.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 10: Frequency Analysis with the DFT</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mireille Boutin, Alden Bradford<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>